#!/usr/bin/env bash

CONST_FILE=${PWD}/cmd/donut/build-constants.go

cat > $CONST_FILE <<EOF
/*
 * ** DO NOT EDIT THIS FILE. THIS FILE IS AUTO GENERATED BY RUNNING MAKE **
 */

package main

const (
	gitCommitHash = "__GIT_COMMIT_HASH__"
)
EOF

commit_id=$(git log --format="%H" -n 1)
sed -i "s/__GIT_COMMIT_HASH__/$commit_id/" $CONST_FILE
